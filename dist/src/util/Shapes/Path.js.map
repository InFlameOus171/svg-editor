{"version":3,"file":"Path.js","sourceRoot":"","sources":["../../../../src/util/Shapes/Path.ts"],"names":[],"mappings":"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","sourcesContent":["import type {\r\n  BoundaryCoordinates,\r\n  Coordinates,\r\n  SVGDrawPath,\r\n  SVGParamsBase,\r\n} from '../../types/types';\r\nimport { getPathBoundaries, sumOfCoordinates } from '../helper/coordinates';\r\nimport { singleDirectionCommands } from '../helper/util';\r\nimport { Shape } from './Shape';\r\n\r\nexport class Path extends Shape {\r\n  drawPath: SVGDrawPath[];\r\n  #rawDrawPath: SVGDrawPath[];\r\n  #center: Coordinates = [-1, -1];\r\n\r\n  constructor(\r\n    drawPath: SVGDrawPath[],\r\n    svgParams?: Partial<SVGParamsBase>,\r\n    dontCountUp?: boolean,\r\n    isLocked: boolean = false\r\n  ) {\r\n    super(undefined, svgParams, dontCountUp, isLocked);\r\n    this.#rawDrawPath = drawPath;\r\n    this.drawPath = drawPath.map(path => {\r\n      if (singleDirectionCommands.includes(path.command)) {\r\n        return { command: path.command, points: path.points };\r\n      }\r\n      return {\r\n        command: path.command,\r\n        points: path.points,\r\n      };\r\n    });\r\n    if (svgParams?.bBox) {\r\n      const { x, y, width, height } = svgParams.bBox;\r\n      const boundaries = [\r\n        [x, y],\r\n        [x, y + height],\r\n        [x + width, y],\r\n        [x + width, y + height],\r\n      ];\r\n      this.boundaries = boundaries.map(boundary => {\r\n        const point = new DOMPoint(boundary[0], boundary[1]);\r\n        const transformedPoint = point.matrixTransform(this.transformMatrix);\r\n        return [transformedPoint.x, transformedPoint.y];\r\n      }) as BoundaryCoordinates;\r\n    } else {\r\n      this.boundaries = getPathBoundaries(this.drawPath);\r\n    }\r\n    const sumOfBoundaries = this.boundaries.reduce(\r\n      (acc, curr) => sumOfCoordinates(acc)(curr),\r\n      [0, 0]\r\n    );\r\n    this.#center = [sumOfBoundaries[0] / 4, sumOfBoundaries[1] / 4];\r\n  }\r\n\r\n  getCenter: () => Coordinates = () => {\r\n    return this.#center;\r\n  };\r\n\r\n  toSVGPathParams = () => ({\r\n    d: this.toString(),\r\n    ...this.getSvgParams(),\r\n  });\r\n\r\n  getDeconstructedShapeData = () => ({\r\n    id: this.getId(),\r\n    type: 'Path',\r\n    drawPath: this.#rawDrawPath,\r\n    isLocked: this.isLocked,\r\n    svgParams: this.getSvgParams(),\r\n  });\r\n\r\n  moveTo = (coordinates: Coordinates) => {\r\n    const [dx, dy] = [\r\n      coordinates[0] - this.#center[0],\r\n      coordinates[1] - this.#center[1],\r\n    ];\r\n    this.moveTransformMatrix(dx, dy);\r\n    this.#center = [this.#center[0] + dx, this.#center[1] + dy];\r\n    this.boundaries = this.boundaries.map(boundary => [\r\n      boundary[0] + dx,\r\n      boundary[1] + dy,\r\n    ]) as BoundaryCoordinates;\r\n  };\r\n\r\n  toString = (): string => {\r\n    const result = this.drawPath.reduce(\r\n      (acc: string, pathValue: SVGDrawPath) => {\r\n        return acc\r\n          .concat(\r\n            ' ',\r\n            pathValue.command,\r\n            ' ',\r\n            Array.isArray(pathValue.points)\r\n              ? pathValue.points.reduce(\r\n                  (acc: string, point: Coordinates) =>\r\n                    acc.concat(\r\n                      [point[0].toString(), point[1].toString()].join(),\r\n                      ' '\r\n                    ),\r\n                  ''\r\n                )\r\n              : pathValue.points ?? '',\r\n            ' '\r\n          )\r\n          .trim();\r\n      },\r\n      ''\r\n    );\r\n    return result;\r\n  };\r\n}\r\n"]}